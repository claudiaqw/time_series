knitr::opts_chunk$set(echo = TRUE)
library(lubridate)
library(lubridate)
library(ggplot2)
library(plotly)
library(tseries)
library(MASS)
library(forecast)
setwd("D:/Study/Master en Data Science - AFI/Series temporales - Daniel Vélez-20210413/time_series")
original <- readxl::read_xlsx("./data/Hipotecas.xlsx")
original <- original[c('...1', '01 Álava', '20 Gipuzkoa', '48 Vizcaya')]
original$date <- as.Date(paste(original$date, "01", sep = "-"), "%YM%m-%d")
original$total <- original$Alava + original$Gipuzkoa + original$Vizcaya
original$date <- as.Date(paste(original$date, "01", sep = "-"), "%YM%m-%d")
original$total <- original$Alava + original$Gipuzkoa + original$Vizcaya
View(original)
View(original)
original <- readxl::read_xlsx("./data/Hipotecas.xlsx")
original <- original[c('...1', '01 Álava', '20 Gipuzkoa', '48 Vizcaya')]
colnames(original) <- c('date', 'Alava', 'Gipuzkoa', 'Vizcaya')
View(original)
View(original)
original$date <- as.Date(paste(original$date, "01", sep = "-"), "%YM%m-%d")
View(original)
View(original)
original$total <- original$Alava + original$Gipuzkoa + original$Vizcaya
data <- original[c('date', 'total')]
data.train <- subset(data, year(data$date) != 2019)
data.test <- subset(data, year(data$date) == 2019)
data.train.ts <- as.ts(data.train$total, frequency = 12)
data.test.ts <- as.ts(data.test$total, frequency=12)
ggplot(aes(x= date, y = total), data = data.train) +
geom_line(color = '#d84519', size = 1) +
xlab('FECHA') + ylab('Hipotecas')
box_cox <- boxcox(total ~ date,
data = data.train,
lambda = c(0, 0.5, 1))
lambda <- box_cox$x[which.max(box_cox$y)]
lambda
data.train$exp_total = data.train$total**lambda
data.test$exp_total = data.test$total**lambda
data.train.ts <- as.ts(data.train$exp_total, frequency = 12)
data.test.ts <- as.ts(data.test$exp_total, frequency=12)
```{r}
data.test.ts <- as.ts(data.test$exp_total, frequency=12)
adf.test(data.train.ts)
acf(data.train.ts, lag.max = 48, xlab = "Hipotecas",
main= "Función de autocorrelacion simple")
pacf(data.train.ts, lag.max = 48, xlab = "Hipotecas",
main = "Funcion de autocorrelacion parcial")
fit.1 <- Arima(data.train.ts,
order = c(1, 0, 0),
method = 'ML')
fit.1
library(lmtest)
library(lubridate)
library(ggplot2)
library(plotly)
library(tseries)
library(lmtest)
library(MASS)
library(forecast)
coeftest(fit.1)
cor.arma(fit.1)
install.packages("caschrono")
library(caschrono)
cor.arma(fit.1)
Box.test.2(residuals(fit.1),
nlag = c(6, 12, 18, 24, 30, 36, 48))
acf(fit.1$residuals, lag.max = 48, xlab = "Hipotecas",
main= "Función de autocorrelacion simple")
pacf(fit.1$residuals, lag.max = 48, xlab = "Hipotecas",
main = "Funcion de autocorrelacion parcial")
fit.2 <- Arima(data.train.ts,
order = c(1, 0, 0),
seasonal = list(order = c(1, 0, 0), period=12),
method = 'ML')
fit.2
coeftest(fit.2)
